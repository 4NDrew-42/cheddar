(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[85],{2705:(e,t,a)=>{Promise.resolve().then(a.bind(a,6821))},6821:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>u,dynamic:()=>c});var l=a(5155),s=a(2615),n=a(2115);function i(e){var t;let{post:a,onSave:s}=e,[i,r]=(0,n.useState)({title:(null==a?void 0:a.title)||"",copy:(null==a?void 0:a.copy)||"",mediaUrl:(null==a?void 0:a.mediaUrl)||"",mediaType:(null==a?void 0:a.mediaType)||"image",platform:(null==a?void 0:a.platform)||[],date:(null==a?void 0:a.date)||new Date,status:(null==a?void 0:a.status)||"Draft"}),d=async e=>{e.preventDefault(),await s(i)};return(0,l.jsxs)("form",{onSubmit:d,className:"space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Title"}),(0,l.jsx)("input",{type:"text",value:i.title,onChange:e=>r({...i,title:e.target.value}),className:"w-full p-2 border rounded",required:!0})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Content"}),(0,l.jsx)("textarea",{value:i.copy,onChange:e=>r({...i,copy:e.target.value}),className:"w-full p-2 border rounded",rows:4})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Media URL"}),(0,l.jsx)("input",{type:"url",value:i.mediaUrl,onChange:e=>r({...i,mediaUrl:e.target.value}),className:"w-full p-2 border rounded"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Media Type"}),(0,l.jsxs)("select",{value:i.mediaType,onChange:e=>r({...i,mediaType:e.target.value}),className:"w-full p-2 border rounded",children:[(0,l.jsx)("option",{value:"image",children:"Image"}),(0,l.jsx)("option",{value:"video",children:"Video"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Platforms"}),(0,l.jsx)("input",{type:"text",value:null===(t=i.platform)||void 0===t?void 0:t.join(", "),onChange:e=>r({...i,platform:e.target.value.split(",").map(e=>e.trim())}),className:"w-full p-2 border rounded",placeholder:"Comma separated platforms"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Date"}),(0,l.jsx)("input",{type:"datetime-local",value:i.date?new Date(i.date).toISOString().slice(0,16):"",onChange:e=>r({...i,date:new Date(e.target.value)}),className:"w-full p-2 border rounded"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Status"}),(0,l.jsxs)("select",{value:i.status,onChange:e=>r({...i,status:e.target.value}),className:"w-full p-2 border rounded",children:[(0,l.jsx)("option",{value:"Draft",children:"Draft"}),(0,l.jsx)("option",{value:"Scheduled",children:"Scheduled"}),(0,l.jsx)("option",{value:"Published",children:"Published"})]})]}),(0,l.jsx)("button",{type:"submit",className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:a?"Update Post":"Create Post"})]})}var r=a(936);a(6769);var d=a(6046),o=a(8932);let c="force-dynamic";function u(){let{data:e,status:t}=(0,s.useSession)(),[a,c]=(0,n.useState)([]),[u,m]=(0,n.useState)(!0),[h,p]=(0,n.useState)(null),x=(0,d.useRouter)();return((0,n.useEffect)(()=>{if("unauthenticated"===t){x.push("/");return}"authenticated"===t&&(null==e?void 0:e.user)&&(m(!0),p(null),fetch("".concat(o.$.apiUrl,"/posts"),{headers:{"Content-Type":"application/json"},credentials:"include"}).then(async e=>{if(!e.ok)throw Error((await e.json()).message||"Failed to fetch posts");return e.json()}).then(e=>c(e)).catch(e=>{console.error("Error fetching posts:",e),p(e.message)}).finally(()=>m(!1)))},[t,e,x]),"loading"===t||u)?(0,l.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,l.jsx)("div",{className:"text-lg animate-pulse",children:"Loading..."})}):h?(0,l.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,l.jsxs)("div",{className:"text-red-500",children:["Error: ",h]})}):"unauthenticated"===t?null:(0,l.jsxs)("div",{className:"p-4",children:[(0,l.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"My Content Calendar"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,l.jsx)("div",{className:"lg:col-span-1",children:(0,l.jsx)(i,{onSave:async e=>{try{let t=await fetch("".concat(o.$.apiUrl,"/posts"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)});if(!t.ok){let e=await t.json();throw Error(e.message||"Failed to create post")}let l=await t.json();c([...a,l])}catch(e){console.error("Error creating post:",e),p(e instanceof Error?e.message:"Failed to create post")}}})}),(0,l.jsx)(r.Ay,{tileContent:e=>{let{date:t}=e;return a.map(e=>new Date(e.date).toDateString()).includes(t.toDateString())?(0,l.jsx)("div",{className:"w-1 h-1 bg-blue-500 rounded-full mx-auto"}):null}}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Scheduled Posts"}),(0,l.jsx)("div",{className:"space-y-4",children:a.map(e=>(0,l.jsxs)("div",{className:"p-4 border rounded-lg",children:[(0,l.jsx)("h3",{className:"font-medium",children:e.title}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:new Date(e.date).toLocaleString()})]},e._id))})]})]})]})}},8932:(e,t,a)=>{"use strict";a.d(t,{$:()=>n});var l=a(2818);let s=l.env.NEXTAUTH_URL?l.env.NEXTAUTH_URL:"http://localhost:3000",n={baseUrl:s,apiUrl:"".concat(s,"/api"),auth:{callbackUrl:s,loginPage:"".concat(s,"/api/auth/signin")}}}},e=>{var t=t=>e(e.s=t);e.O(0,[0,615,667,441,517,358],()=>t(2705)),_N_E=e.O()}]);